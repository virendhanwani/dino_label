{"ast":null,"code":"import { useCallback } from 'react';\nimport { useDelete } from '../../dataProvider';\nimport { CRUD_DELETE } from '../../actions';\nimport { useRefresh, useNotify, useRedirect } from '../../sideEffect';\nimport { useResourceContext } from '../../core';\n/**\n * Prepare callback for a Delete button with undo support\n *\n * @example\n *\n * import React from 'react';\n * import ActionDelete from '@material-ui/icons/Delete';\n * import { Button, useDeleteWithUndoController } from 'react-admin';\n *\n * const DeleteButton = ({\n *     resource,\n *     record,\n *     basePath,\n *     redirect,\n *     onClick,\n *     ...rest\n * }) => {\n *     const { loading, handleDelete } = useDeleteWithUndoController({\n *         resource,\n *         record,\n *         basePath,\n *         redirect,\n *         onClick,\n *     });\n *\n *     return (\n *         <Button\n *             onClick={handleDelete}\n *             disabled={loading}\n *             label=\"ra.action.delete\"\n *             {...rest}\n *         >\n *             <ActionDelete />\n *         </Button>\n *     );\n * };\n */\nvar useDeleteWithUndoController = function (props) {\n  var record = props.record,\n    basePath = props.basePath,\n    _a = props.redirect,\n    redirectTo = _a === void 0 ? 'list' : _a,\n    onClick = props.onClick,\n    onSuccess = props.onSuccess,\n    onFailure = props.onFailure;\n  var resource = useResourceContext(props);\n  var notify = useNotify();\n  var redirect = useRedirect();\n  var refresh = useRefresh();\n  var _b = useDelete(resource, null, null, {\n      action: CRUD_DELETE,\n      onSuccess: onSuccess !== undefined ? onSuccess : function () {\n        notify('ra.notification.deleted', {\n          type: 'info',\n          messageArgs: {\n            smart_count: 1\n          },\n          undoable: true\n        });\n        redirect(redirectTo, basePath || \"/\" + resource);\n        refresh();\n      },\n      onFailure: onFailure !== undefined ? onFailure : function (error) {\n        notify(typeof error === 'string' ? error : error.message || 'ra.notification.http_error', {\n          type: 'warning',\n          messageArgs: {\n            _: typeof error === 'string' ? error : error && error.message ? error.message : undefined\n          }\n        });\n        refresh();\n      },\n      mutationMode: 'undoable'\n    }),\n    deleteOne = _b[0],\n    loading = _b[1].loading;\n  var handleDelete = useCallback(function (event) {\n    event.stopPropagation();\n    deleteOne({\n      payload: {\n        id: record.id,\n        previousData: record\n      }\n    });\n    if (typeof onClick === 'function') {\n      onClick(event);\n    }\n  }, [deleteOne, onClick, record]);\n  return {\n    loading: loading,\n    handleDelete: handleDelete\n  };\n};\nexport default useDeleteWithUndoController;","map":{"version":3,"names":["useCallback","useDelete","CRUD_DELETE","useRefresh","useNotify","useRedirect","useResourceContext","useDeleteWithUndoController","props","record","basePath","_a","redirect","redirectTo","onClick","onSuccess","onFailure","resource","notify","refresh","_b","action","undefined","type","messageArgs","smart_count","undoable","error","message","_","mutationMode","deleteOne","loading","handleDelete","event","stopPropagation","payload","id","previousData"],"sources":["/app/node_modules/ra-core/esm/controller/button/useDeleteWithUndoController.js"],"sourcesContent":["import { useCallback } from 'react';\nimport { useDelete } from '../../dataProvider';\nimport { CRUD_DELETE } from '../../actions';\nimport { useRefresh, useNotify, useRedirect, } from '../../sideEffect';\nimport { useResourceContext } from '../../core';\n/**\n * Prepare callback for a Delete button with undo support\n *\n * @example\n *\n * import React from 'react';\n * import ActionDelete from '@material-ui/icons/Delete';\n * import { Button, useDeleteWithUndoController } from 'react-admin';\n *\n * const DeleteButton = ({\n *     resource,\n *     record,\n *     basePath,\n *     redirect,\n *     onClick,\n *     ...rest\n * }) => {\n *     const { loading, handleDelete } = useDeleteWithUndoController({\n *         resource,\n *         record,\n *         basePath,\n *         redirect,\n *         onClick,\n *     });\n *\n *     return (\n *         <Button\n *             onClick={handleDelete}\n *             disabled={loading}\n *             label=\"ra.action.delete\"\n *             {...rest}\n *         >\n *             <ActionDelete />\n *         </Button>\n *     );\n * };\n */\nvar useDeleteWithUndoController = function (props) {\n    var record = props.record, basePath = props.basePath, _a = props.redirect, redirectTo = _a === void 0 ? 'list' : _a, onClick = props.onClick, onSuccess = props.onSuccess, onFailure = props.onFailure;\n    var resource = useResourceContext(props);\n    var notify = useNotify();\n    var redirect = useRedirect();\n    var refresh = useRefresh();\n    var _b = useDelete(resource, null, null, {\n        action: CRUD_DELETE,\n        onSuccess: onSuccess !== undefined\n            ? onSuccess\n            : function () {\n                notify('ra.notification.deleted', {\n                    type: 'info',\n                    messageArgs: { smart_count: 1 },\n                    undoable: true,\n                });\n                redirect(redirectTo, basePath || \"/\" + resource);\n                refresh();\n            },\n        onFailure: onFailure !== undefined\n            ? onFailure\n            : function (error) {\n                notify(typeof error === 'string'\n                    ? error\n                    : error.message || 'ra.notification.http_error', {\n                    type: 'warning',\n                    messageArgs: {\n                        _: typeof error === 'string'\n                            ? error\n                            : error && error.message\n                                ? error.message\n                                : undefined,\n                    },\n                });\n                refresh();\n            },\n        mutationMode: 'undoable',\n    }), deleteOne = _b[0], loading = _b[1].loading;\n    var handleDelete = useCallback(function (event) {\n        event.stopPropagation();\n        deleteOne({\n            payload: { id: record.id, previousData: record },\n        });\n        if (typeof onClick === 'function') {\n            onClick(event);\n        }\n    }, [deleteOne, onClick, record]);\n    return { loading: loading, handleDelete: handleDelete };\n};\nexport default useDeleteWithUndoController;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}