{"ast":null,"code":"import { useCallback } from 'react';\nimport useVersion from '../useVersion';\nimport { useCheckMinimumRequiredProps } from '../checkMinimumRequiredProps';\nimport { useNotify, useRedirect, useRefresh } from '../../sideEffect';\nimport { useGetOne, useUpdate } from '../../dataProvider';\nimport { useTranslate } from '../../i18n';\nimport { CRUD_GET_ONE, CRUD_UPDATE } from '../../actions';\nimport { useSaveModifiers } from '../saveModifiers';\nimport { useResourceContext, useGetResourceLabel } from '../../core';\n/**\n * Prepare data for the Edit view\n *\n * @param {Object} props The props passed to the Edit component.\n *\n * @return {Object} controllerProps Fetched data and callbacks for the Edit view\n *\n * @example\n *\n * import { useEditController } from 'react-admin';\n * import EditView from './EditView';\n *\n * const MyEdit = props => {\n *     const controllerProps = useEditController(props);\n *     return <EditView {...controllerProps} {...props} />;\n * }\n */\nexport var useEditController = function (props) {\n  useCheckMinimumRequiredProps('Edit', ['basePath', 'resource'], props);\n  var basePath = props.basePath,\n    hasCreate = props.hasCreate,\n    hasEdit = props.hasEdit,\n    hasList = props.hasList,\n    hasShow = props.hasShow,\n    id = props.id,\n    successMessage = props.successMessage,\n    // @deprecated use mutationMode: undoable instead\n    _a = props.undoable,\n    // @deprecated use mutationMode: undoable instead\n    undoable = _a === void 0 ? true : _a,\n    onSuccess = props.onSuccess,\n    onFailure = props.onFailure,\n    _b = props.mutationMode,\n    mutationMode = _b === void 0 ? undoable ? 'undoable' : undefined : _b,\n    transform = props.transform;\n  var resource = useResourceContext(props);\n  var translate = useTranslate();\n  var notify = useNotify();\n  var redirect = useRedirect();\n  var refresh = useRefresh();\n  var version = useVersion();\n  if (process.env.NODE_ENV !== 'production' && successMessage) {\n    console.log('<Edit successMessage> prop is deprecated, use the onSuccess prop instead.');\n  }\n  var _c = useSaveModifiers({\n      onSuccess: onSuccess,\n      onFailure: onFailure,\n      transform: transform\n    }),\n    onSuccessRef = _c.onSuccessRef,\n    setOnSuccess = _c.setOnSuccess,\n    onFailureRef = _c.onFailureRef,\n    setOnFailure = _c.setOnFailure,\n    transformRef = _c.transformRef,\n    setTransform = _c.setTransform;\n  var _d = useGetOne(resource, id, {\n      action: CRUD_GET_ONE,\n      onFailure: function () {\n        notify('ra.notification.item_doesnt_exist', {\n          type: 'warning'\n        });\n        redirect('list', basePath);\n        refresh();\n      }\n    }),\n    record = _d.data,\n    error = _d.error,\n    loading = _d.loading,\n    loaded = _d.loaded,\n    refetch = _d.refetch;\n  var getResourceLabel = useGetResourceLabel();\n  var defaultTitle = translate('ra.page.edit', {\n    name: getResourceLabel(resource, 1),\n    id: id,\n    record: record\n  });\n  var _e = useUpdate(resource, id, {},\n    // set by the caller\n    record),\n    update = _e[0],\n    saving = _e[1].loading;\n  var save = useCallback(function (data, redirectTo, _a) {\n    if (redirectTo === void 0) {\n      redirectTo = DefaultRedirect;\n    }\n    var _b = _a === void 0 ? {} : _a,\n      onSuccessFromSave = _b.onSuccess,\n      onFailureFromSave = _b.onFailure,\n      transformFromSave = _b.transform;\n    return Promise.resolve(transformFromSave ? transformFromSave(data) : transformRef.current ? transformRef.current(data) : data).then(function (data) {\n      return update({\n        payload: {\n          data: data\n        }\n      }, {\n        action: CRUD_UPDATE,\n        onSuccess: onSuccessFromSave ? onSuccessFromSave : onSuccessRef.current ? onSuccessRef.current : function () {\n          notify(successMessage || 'ra.notification.updated', {\n            type: 'info',\n            messageArgs: {\n              smart_count: 1\n            },\n            undoable: mutationMode === 'undoable'\n          });\n          redirect(redirectTo, basePath, data.id, data);\n        },\n        onFailure: onFailureFromSave ? onFailureFromSave : onFailureRef.current ? onFailureRef.current : function (error) {\n          notify(typeof error === 'string' ? error : error.message || 'ra.notification.http_error', {\n            type: 'warning',\n            messageArgs: {\n              _: typeof error === 'string' ? error : error && error.message ? error.message : undefined\n            }\n          });\n          if (mutationMode === 'undoable' || mutationMode === 'pessimistic') {\n            refresh();\n          }\n        },\n        mutationMode: mutationMode\n      });\n    });\n  }, [transformRef, update, onSuccessRef, onFailureRef, notify, successMessage, redirect, basePath, refresh, mutationMode]);\n  return {\n    error: error,\n    loading: loading,\n    loaded: loaded,\n    saving: saving,\n    defaultTitle: defaultTitle,\n    hasCreate: hasCreate,\n    hasEdit: hasEdit,\n    hasList: hasList,\n    hasShow: hasShow,\n    onSuccessRef: onSuccessRef,\n    onFailureRef: onFailureRef,\n    transformRef: transformRef,\n    save: save,\n    setOnSuccess: setOnSuccess,\n    setOnFailure: setOnFailure,\n    setTransform: setTransform,\n    refetch: refetch,\n    resource: resource,\n    basePath: basePath,\n    record: record,\n    redirect: DefaultRedirect,\n    version: version\n  };\n};\nvar DefaultRedirect = 'list';","map":{"version":3,"names":["useCallback","useVersion","useCheckMinimumRequiredProps","useNotify","useRedirect","useRefresh","useGetOne","useUpdate","useTranslate","CRUD_GET_ONE","CRUD_UPDATE","useSaveModifiers","useResourceContext","useGetResourceLabel","useEditController","props","basePath","hasCreate","hasEdit","hasList","hasShow","id","successMessage","_a","undoable","onSuccess","onFailure","_b","mutationMode","undefined","transform","resource","translate","notify","redirect","refresh","version","process","env","NODE_ENV","console","log","_c","onSuccessRef","setOnSuccess","onFailureRef","setOnFailure","transformRef","setTransform","_d","action","type","record","data","error","loading","loaded","refetch","getResourceLabel","defaultTitle","name","_e","update","saving","save","redirectTo","DefaultRedirect","onSuccessFromSave","onFailureFromSave","transformFromSave","Promise","resolve","current","then","payload","messageArgs","smart_count","message","_"],"sources":["/node_modules/ra-core/esm/controller/details/useEditController.js"],"sourcesContent":["import { useCallback } from 'react';\nimport useVersion from '../useVersion';\nimport { useCheckMinimumRequiredProps } from '../checkMinimumRequiredProps';\nimport { useNotify, useRedirect, useRefresh, } from '../../sideEffect';\nimport { useGetOne, useUpdate } from '../../dataProvider';\nimport { useTranslate } from '../../i18n';\nimport { CRUD_GET_ONE, CRUD_UPDATE } from '../../actions';\nimport { useSaveModifiers, } from '../saveModifiers';\nimport { useResourceContext, useGetResourceLabel } from '../../core';\n/**\n * Prepare data for the Edit view\n *\n * @param {Object} props The props passed to the Edit component.\n *\n * @return {Object} controllerProps Fetched data and callbacks for the Edit view\n *\n * @example\n *\n * import { useEditController } from 'react-admin';\n * import EditView from './EditView';\n *\n * const MyEdit = props => {\n *     const controllerProps = useEditController(props);\n *     return <EditView {...controllerProps} {...props} />;\n * }\n */\nexport var useEditController = function (props) {\n    useCheckMinimumRequiredProps('Edit', ['basePath', 'resource'], props);\n    var basePath = props.basePath, hasCreate = props.hasCreate, hasEdit = props.hasEdit, hasList = props.hasList, hasShow = props.hasShow, id = props.id, successMessage = props.successMessage, \n    // @deprecated use mutationMode: undoable instead\n    _a = props.undoable, \n    // @deprecated use mutationMode: undoable instead\n    undoable = _a === void 0 ? true : _a, onSuccess = props.onSuccess, onFailure = props.onFailure, _b = props.mutationMode, mutationMode = _b === void 0 ? undoable ? 'undoable' : undefined : _b, transform = props.transform;\n    var resource = useResourceContext(props);\n    var translate = useTranslate();\n    var notify = useNotify();\n    var redirect = useRedirect();\n    var refresh = useRefresh();\n    var version = useVersion();\n    if (process.env.NODE_ENV !== 'production' && successMessage) {\n        console.log('<Edit successMessage> prop is deprecated, use the onSuccess prop instead.');\n    }\n    var _c = useSaveModifiers({ onSuccess: onSuccess, onFailure: onFailure, transform: transform }), onSuccessRef = _c.onSuccessRef, setOnSuccess = _c.setOnSuccess, onFailureRef = _c.onFailureRef, setOnFailure = _c.setOnFailure, transformRef = _c.transformRef, setTransform = _c.setTransform;\n    var _d = useGetOne(resource, id, {\n        action: CRUD_GET_ONE,\n        onFailure: function () {\n            notify('ra.notification.item_doesnt_exist', { type: 'warning' });\n            redirect('list', basePath);\n            refresh();\n        },\n    }), record = _d.data, error = _d.error, loading = _d.loading, loaded = _d.loaded, refetch = _d.refetch;\n    var getResourceLabel = useGetResourceLabel();\n    var defaultTitle = translate('ra.page.edit', {\n        name: getResourceLabel(resource, 1),\n        id: id,\n        record: record,\n    });\n    var _e = useUpdate(resource, id, {}, // set by the caller\n    record), update = _e[0], saving = _e[1].loading;\n    var save = useCallback(function (data, redirectTo, _a) {\n        if (redirectTo === void 0) { redirectTo = DefaultRedirect; }\n        var _b = _a === void 0 ? {} : _a, onSuccessFromSave = _b.onSuccess, onFailureFromSave = _b.onFailure, transformFromSave = _b.transform;\n        return Promise.resolve(transformFromSave\n            ? transformFromSave(data)\n            : transformRef.current\n                ? transformRef.current(data)\n                : data).then(function (data) {\n            return update({ payload: { data: data } }, {\n                action: CRUD_UPDATE,\n                onSuccess: onSuccessFromSave\n                    ? onSuccessFromSave\n                    : onSuccessRef.current\n                        ? onSuccessRef.current\n                        : function () {\n                            notify(successMessage ||\n                                'ra.notification.updated', {\n                                type: 'info',\n                                messageArgs: { smart_count: 1 },\n                                undoable: mutationMode === 'undoable',\n                            });\n                            redirect(redirectTo, basePath, data.id, data);\n                        },\n                onFailure: onFailureFromSave\n                    ? onFailureFromSave\n                    : onFailureRef.current\n                        ? onFailureRef.current\n                        : function (error) {\n                            notify(typeof error === 'string'\n                                ? error\n                                : error.message ||\n                                    'ra.notification.http_error', {\n                                type: 'warning',\n                                messageArgs: {\n                                    _: typeof error === 'string'\n                                        ? error\n                                        : error && error.message\n                                            ? error.message\n                                            : undefined,\n                                },\n                            });\n                            if (mutationMode === 'undoable' ||\n                                mutationMode === 'pessimistic') {\n                                refresh();\n                            }\n                        },\n                mutationMode: mutationMode,\n            });\n        });\n    }, [\n        transformRef,\n        update,\n        onSuccessRef,\n        onFailureRef,\n        notify,\n        successMessage,\n        redirect,\n        basePath,\n        refresh,\n        mutationMode,\n    ]);\n    return {\n        error: error,\n        loading: loading,\n        loaded: loaded,\n        saving: saving,\n        defaultTitle: defaultTitle,\n        hasCreate: hasCreate,\n        hasEdit: hasEdit,\n        hasList: hasList,\n        hasShow: hasShow,\n        onSuccessRef: onSuccessRef,\n        onFailureRef: onFailureRef,\n        transformRef: transformRef,\n        save: save,\n        setOnSuccess: setOnSuccess,\n        setOnFailure: setOnFailure,\n        setTransform: setTransform,\n        refetch: refetch,\n        resource: resource,\n        basePath: basePath,\n        record: record,\n        redirect: DefaultRedirect,\n        version: version,\n    };\n};\nvar DefaultRedirect = 'list';\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}